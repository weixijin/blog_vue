import{q as u,k as h,o as _,n as m}from"./index.25833e42.js";var p=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("TrainPage",{ref:"TrainPageRef",attrs:{searchConfig:e.searchConfig,tableConfig:e.tableConfig,sendUrl:"get_classs",customize:""},on:{sortEnd:e.sortEnd},scopedSlots:e._u([{key:"roles",fn:function(s){var i=s.record;return[t("el-checkbox-group",{attrs:{min:1},on:{change:function(l){return e.changeFun(i)}},model:{value:i.roles,callback:function(l){e.$set(i,"roles",l)},expression:"record.roles"}},e._l(e.userRoles,function(l){return t("el-checkbox",{key:e.indey+l,attrs:{label:l}},[e._v(e._s(l))])}),1)]}}])},[t("template",{slot:"btnList"},[t("el-button",{attrs:{type:"primary"},on:{click:e.openDialog}},[e._v("\u65B0\u589E")])],1)],2),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(s){e.dialogVisible=s},close:e.handleClose}},[t("div",{staticClass:"dialog-main"},[t("div",{staticClass:"flex-center-wrap"},[t("div",{staticClass:"d-label"},[e._v("\u5206\u7C7B\u540D\u79F0\uFF1A")]),t("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u7C7B\u540D",maxlength:"20","show-word-limit":""},model:{value:e.rowData.class_name,callback:function(s){e.$set(e.rowData,"class_name",typeof s=="string"?s.trim():s)},expression:"rowData.class_name"}})],1),t("div",{staticClass:"m-t-10 flex-center-wrap"},[t("div",{staticClass:"d-label"},[e._v("\u8BBE\u7F6E\u4E3A\u5FC3\u5F97\u8BB0\u5F55\uFF1A")]),t("el-switch",{model:{value:e.value,callback:function(s){e.value=s},expression:"value"}})],1)]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("\u53D6 \u6D88")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("\u786E \u5B9A")])],1)])],1)},g=[];const f={data(){return{searchConfig:[],tableConfig:{sort:!0,isSelection:!1,maxHeightFlag:!1,stripe:!0,filterData:e=>(this.$store.commit("SET_NAV_LIST",e),e.map((a,t)=>{let{create_time:s,updata_time:i}=a;return{...a,create_time_:this.klDateFormat(s),updata_time_:this.klDateFormat(i)}})),columnObj:[{label:"\u5206\u7C7B\u540D\u79F0",props:"class_name"},{label:"\u5C55\u793A\u6743\u9650",props:"roles",slot:"roles"},{label:"\u64CD\u4F5C",slot:"projectDetail",props:"action",lock:!0,fixed:"right",children:[{label:"\u7F16\u8F91",type:"warning",clickFn:e=>{this.edit(e,"edit")}},{label:"\u5220\u9664",type:"danger",clickFn:e=>{this.del(e,"del")}}]}]},value:!1,rowData:{class_name:""},dialogVisible:!1,dialogTitle:"",maxHeight:0,headerOption:[{name:"\u5206\u7C7B\u540D\u79F0",key:"class_name",flex:1},{name:"\u5C55\u793A\u6743\u9650",key:"roles",width:300,custom:"roles"},{name:"\u64CD\u4F5C",key:"action",width:200,custom:"operation"}]}},computed:{...Vuex.mapState(["navlist","options"]),...Vuex.mapMutations(["SET_NAV_LIST"]),userRoles(){return this.options.userRoles||[]}},methods:{sortEnd({newList:e}={}){const a=e.map(t=>t._id).join(",");this.$apis.put_options({blog_class_option:a}).then(t=>{var o;const{blog_class_option:s=""}=((o=t==null?void 0:t.data)==null?void 0:o.list)||{},i=s.split(","),l=[];i.forEach(c=>{const n=this.navlist.find(d=>d._id===c);n&&l.push(n)}),this.$store.commit("SET_NAV_LIST",l),this.$message.success("\u64CD\u4F5C\u6210\u529F")}).catch(t=>{this.getTableData()})},getTableData(){this.$refs.TrainPageRef.getAddData()},changeFun(e){this.rowData=e,this.value=+e.class_mark==1,this.submit()},edit(e){this.openDialog(e),this.rowData=this.deepCopy(e),this.value=+e.class_mark==1},del(e){this.$confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u8BE5\u5206\u7C7B, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{u({_id:e._id}).then(()=>{this.$message.success("\u5220\u9664\u6210\u529F"),this.getTableData()})}).catch(a=>{this.Toast(a)})},async submit(){let{rowData:{_id:e,class_name:a,roles:t},value:s}=this;if(!a)return this.$message.error("\u8BF7\u8F93\u5165\u5185\u5BB9");let i={class_name:a};if(i.class_mark=s?1:"",e&&(i._id=e),Array.isArray(t)&&(i.roles=t),e){h(i).then(l=>{this.$message.success("\u7F16\u8F91\u6210\u529F"),this.getTableData(),this.dialogVisible=!1}).catch(()=>{});return}_(i).then(l=>{this.$message.success("\u65B0\u589E\u6210\u529F"),this.getTableData(),this.dialogVisible=!1}).catch(()=>{})},handleClose(){this.dialogVisible=!1},openDialog(e){this.getType(e)=="object"?this.dialogTitle="\u7F16\u8F91":this.dialogTitle="\u65B0\u589E",this.dialogVisible=!0}}},r={};var b=m(f,p,g,!1,v,"2e116a22",null,null);function v(e){for(let a in r)this[a]=r[a]}var k=function(){return b.exports}();export{k as default};
