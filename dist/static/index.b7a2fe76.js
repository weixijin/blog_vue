import{h as s,n as u}from"./index.25833e42.js";import g from"./index.ae35e4fd.js";var p=function(){var e=this,i=e.$createElement,l=e._self._c||i;return l("div",[l("TrainPage",{ref:"TrainPageRef",attrs:{searchConfig:e.searchConfig,tableConfig:e.tableConfig,sendUrl:"get_plugins",customize:""},scopedSlots:e._u([{key:"author_name",fn:function(t){var r,o=t.record;return[e._v(" "+e._s((o==null||(r=o.author_id)===null||r===void 0?void 0:r.username)||"---")+" ")]}}])}),l("e-dialog",{staticClass:"zl-dialog",attrs:{title:e.dialogOption.title,width:"600px"},on:{closed:e.closeDialogBefore,confirm:e.post_plugin},model:{value:e.dialogOption.dialogVisible,callback:function(t){e.$set(e.dialogOption,"dialogVisible",t)},expression:"dialogOption.dialogVisible"}},[l("div",{staticClass:"dialog-main p-t-20 p-r-20"},[l("el-form",{ref:"addoreditRef",staticClass:"demo-ruleForm",attrs:{model:e.dialogOption.ruleForm,rules:e.dialogOption.rules,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"\u8D44\u6E90\u5730\u5740",prop:"plug_url"}},[l("el-input",{attrs:{type:"url"},model:{value:e.dialogOption.ruleForm.plug_url,callback:function(t){e.$set(e.dialogOption.ruleForm,"plug_url",typeof t=="string"?t.trim():t)},expression:"dialogOption.ruleForm.plug_url"}})],1),l("el-form-item",{attrs:{label:"\u8D44\u6E90\u540D",prop:"plug_title"}},[l("el-input",{attrs:{type:"url"},model:{value:e.dialogOption.ruleForm.plug_title,callback:function(t){e.$set(e.dialogOption.ruleForm,"plug_title",typeof t=="string"?t.trim():t)},expression:"dialogOption.ruleForm.plug_title"}})],1),l("el-form-item",{attrs:{label:"\u8D44\u6E90\u63CF\u8FF0",prop:"plug_content"}},[l("el-input",{attrs:{type:"textarea",row:5},model:{value:e.dialogOption.ruleForm.plug_content,callback:function(t){e.$set(e.dialogOption.ruleForm,"plug_content",t)},expression:"dialogOption.ruleForm.plug_content"}})],1),l("el-form-item",{attrs:{label:"\u8D44\u6E90\u7C7B\u578B"}},[l("el-select",{attrs:{placeholder:"\u8BF7\u9009\u62E9"},model:{value:e.dialogOption.ruleForm.plug_type,callback:function(t){e.$set(e.dialogOption.ruleForm,"plug_type",t)},expression:"dialogOption.ruleForm.plug_type"}},e._l(e.optionsType,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),l("el-form-item",{attrs:{label:"\u8D44\u6E90\u5C01\u9762",prop:"plug_bg_url"}},[l("div",{staticClass:"plugin-bg-container"},[l("div",{directives:[{name:"show",rawName:"v-show",value:!e.dialogOption.ruleForm.plug_bg_url,expression:"!dialogOption.ruleForm.plug_bg_url"}],staticClass:"no-bg",on:{click:e.openImgDialog}},[l("i",{staticClass:"el-icon-plus"})]),l("div",{directives:[{name:"show",rawName:"v-show",value:e.dialogOption.ruleForm.plug_bg_url,expression:"dialogOption.ruleForm.plug_bg_url"}],staticClass:"imgs-cover pr"},[l("i",{staticClass:"el-icon-circle-close pos-close",on:{click:e.clearPluginBgUrl}}),l("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.parseResourceUrl(e.dialogOption.ruleForm.plug_bg_url),"preview-src-list":[e.parseResourceUrl(e.dialogOption.ruleForm.plug_bg_url)]}})],1)])])],1)],1)]),l("selectImgs",{on:{closeSelectDialog:e.closeSelectDialog,determine:e.determine},model:{value:e.isSelectImgsShow,callback:function(t){e.isSelectImgsShow=t},expression:"isSelectImgsShow"}})],1)},c=[];const d={components:{selectImgs:g},data(){return{searchConfig:[{label:"\u8D44\u6E90\u540D",type:"input",modelName:"keywords"},{label:"\u8D44\u6E90\u5206\u7C7B",type:"select",modelName:"plug_type",options:()=>this.optionsType}],tableConfig:{isSelection:!1,maxHeightFlag:!1,stripe:!0,filterData:e=>e.map(i=>{var o;let{plug_updata_time:l,plug_create_time:t,plug_type:r}=i;return{...i,plug_type_:(o=this.optionsType.find(n=>n.value==r))==null?void 0:o.label,plug_updata_time_:this.klDateFormat(l),plug_create_time_:this.klDateFormat(t)}}),btns:{children:[{label:"\u65B0\u589E\u8D44\u6E90",type:"success",clickFn:()=>{this.openDialog("add")}},{label:"\u817E\u8BAF\u5728\u7EBF\u903B\u8F91\u56FE\u5236\u4F5C",type:"warning",clickFn:()=>{this.goTo("https://docs.qq.com/desktop/?u=ba75af147be7448b9d5f8745a3780c4c",{target:"_blank"})}}]},columnObj:[{label:"\u8D44\u6E90\u7C7B\u578B",props:"plug_type_"},{label:"\u8D44\u6E90\u540D",props:"plug_title",clickFn:({plug_type:e,plug_url:i})=>{this.goTo(i,{target:"_blank"})}},{label:"\u8D44\u6E90\u63CF\u8FF0",props:"plug_content"},{label:"\u8D44\u6E90\u66F4\u65B0\u65F6\u95F4",props:"plug_updata_time_"},{label:"\u8D44\u6E90\u521B\u5EFA\u65F6\u95F4",props:"plug_create_time_"},{label:"\u64CD\u4F5C",slot:"projectDetail",props:"action",lock:!0,fixed:"right",children:[{label:"\u7F16\u8F91",type:"warning",clickFn:e=>{this.openDialog("edit",e)}},{label:"\u5220\u9664",type:"danger",clickFn:e=>{this.deleteBug(e)}}]}]},isSelectImgsShow:!1,that:this,dialogOption:{dialogVisible:!1,title:"\u65B0\u589E",_id:"",ruleForm:{_id:"",plug_url:"",plug_title:"",plug_content:"",plug_type:"1",plug_bg_url:""},rules:{plug_url:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D44\u6E90\u5730\u5740",trigger:"blur"},{min:1,message:"\u957F\u5EA6\u5927\u4E8E0",trigger:"blur"}],plug_title:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D44\u6E90\u540D",trigger:"blur"},{min:1,message:"\u957F\u5EA6\u5927\u4E8E0",trigger:"blur"}],plug_content:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D44\u6E90\u63CF\u8FF0",trigger:"blur"},{min:1,message:"\u957F\u5EA6\u5927\u4E8E0",trigger:"blur"}],plug_bg_url:[{required:!0,message:"\u8BF7\u9009\u62E9\u8D44\u6E90\u5C01\u9762\u56FE\u7247",trigger:"blur"},{min:1,message:"\u957F\u5EA6\u5927\u4E8E0",trigger:"blur"}]}}}},computed:{...Vuex.mapState(["options"]),optionsType(){return this.options.plugOption}},methods:{clearPluginBgUrl(){this.dialogOption.ruleForm.plug_bg_url=""},closeSelectDialog(){this.isSelectImgsShow=!1},determine(e){e.length!==0&&(this.dialogOption.ruleForm.plug_bg_url=e[0].imgs_url,this.isSelectImgsShow=!1)},openImgDialog(){this.isSelectImgsShow=!0},deleteBug({_id:e}){this.$confirm("\u786E\u5B9A\u5220\u9664\u5417").then(i=>{s.delete_plugin(this.filterQuery({_id:e})).then(l=>{this.$message.success(l.msg)}).catch().finally(()=>{this.initTable()})}).catch(()=>{this.$message.success("\u53D6\u6D88\u6210\u529F")})},post_plugin(){this.$refs.addoreditRef.validate(e=>{if(e){let{title:i}=this.dialogOption;i==="\u65B0\u589E"&&s.post_plugin(this.filterQuery(this.dialogOption.ruleForm)).then(l=>{this.$message.success(l.msg),this.dialogOption.dialogVisible=!1}).catch().finally(()=>{this.initTable()}),i==="\u7F16\u8F91"&&s.put_plugin(this.filterQuery(this.dialogOption.ruleForm)).then(l=>{this.$message.success(l.msg),this.dialogOption.dialogVisible=!1}).catch().finally(()=>{this.initTable()})}})},closeDialogBefore(){this.dialogOption.ruleForm={_id:"",bug_content:"",plug_type:"1",bug_number:1},this.dialogOption.dialogVisible=!1},openDialog(e="add",i){let l={add:"\u65B0\u589E",edit:"\u7F16\u8F91"};this.dialogOption.title=l[e],e==="edit"&&(this.dialogOption.ruleForm=this.deepClone(i)),this.dialogOption.dialogVisible=!0}}},a={};var m=u(d,p,c,!1,_,"56159a36",null,null);function _(e){for(let i in a)this[i]=a[i]}var f=function(){return m.exports}();export{f as default};
