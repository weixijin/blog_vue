import{n as r,D as l}from"./index.25833e42.js";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("TrainPage",{ref:"TrainPageRef",attrs:{searchConfig:e.searchConfig,tableConfig:e.tableConfig,sendUrl:"get_send_msgs",customize:""},on:{sortEnd:e.sortEnd}}),s("e-dialog",{attrs:{"custom-class":"zl-dialog",title:"\u5BC4\u8BED\u914D\u7F6E",width:"600px","close-on-click-modal":!1},on:{closed:e.handleClose,confirm:e.confirm},model:{value:e.dialogVisible,callback:function(i){e.dialogVisible=i},expression:"dialogVisible"}},[s("div",{staticClass:"zl-dialog-main p-r-20"},[s("e-form",{ref:"ruleFormRef",attrs:{formConfig:e.formConfig,formRule:e.rules,formData:e.formdata}})],1)])],1)},c=[];function a(){return[{label:"\u5185\u5BB9",type:"textarea",modelName:"content",value:"",showWordLimit:!0,width:"430px",autosize:{minRows:3,maxRows:6}}]}const d={name:"sendMsgList",data(){return{rules:{content:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9",trigger:"blur"}]},formConfig:a(),formdata:{_id:"",...l(a())},list:[],searchConfig:[{label:"\u5185\u5BB9",type:"input",modelName:"content"}],tableConfig:{isSelection:!1,maxHeightFlag:!1,stripe:!0,sort:!0,filterData:e=>e.map(t=>{let{create_time:s,update_time:i}=t;return{...t,_create_time:this.klDateFormat(s),_update_time:this.klDateFormat(i)}}),btns:{children:[{label:"\u65B0\u589E",type:"primary",clickFn:e=>{this.dialogVisible=!0}}]},columnObj:[{label:"\u5185\u5BB9",props:"content"},{label:"\u521B\u5EFA\u65F6\u95F4",props:"_create_time"},{label:"\u66F4\u65B0\u65F6\u95F4",props:"_update_time"},{label:"\u64CD\u4F5C",slot:"projectDetail",props:"action",lock:!0,fixed:"right",children:[{label:"\u7F16\u8F91",type:"success",clickFn:e=>{this.editRow(e)}},{label:"\u5220\u9664",type:"danger",clickFn:e=>{this.delSys(e._id)}}]}]},dialogVisible:!1,isLoading:!0}},methods:{sortEnd(e){this.$apis.put_options({blog_class_option:e.newList.map(t=>t._id).join(","),type:"blog_send_msg"}).then(t=>{this.$message.success("\u64CD\u4F5C\u6210\u529F")}).catch(t=>{this.Toast(t)})},editRow(e){this.formdata=this.deepClone(e),this.dialogVisible=!0},confirm(){const{ruleFormRef:e}=this.$refs;e&&e.validateFn().then(t=>{if(t){this.$apis.post_send_msg(this.formdata).then(s=>{this.$message.success(s.msg),this.handleClose(),this.initTable()}).catch(s=>{this.Toast(s)});return}return!1})},handleClose(){this.dialogVisible=!1,Object.assign(this.formdata,{_id:"",content:""})},async delSys(e){if(!!await this.$confirm("\u786E\u5B9A\u5220\u9664\u5417\uFF1F").catch(()=>!1))try{const s=await this.$apis.del_send_msg({_id:e});this.$message.success(s.msg),this.initTable(!0)}catch(s){this.Toast(s)}}}},o={};var m=r(d,n,c,!1,f,null,null,null);function f(e){for(let t in o)this[t]=o[t]}var h=function(){return m.exports}();export{h as default};
