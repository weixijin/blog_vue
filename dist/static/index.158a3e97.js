import{n as b}from"./index.25833e42.js";var v=function(){var a=this,t=a.$createElement;return a._self._c,a._m(0)},_=[function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("div",{staticClass:"box"}),e("div",{staticClass:"aircraftBattle",attrs:{id:"aircraftBattle"}})])}];const k={components:{},data(){return{step:1,imgs:{beginBtn:"https://s1.chu0.com/src/img/png/d3/d3999d2571cd4e64a88c8b5823d14b3c.png?e=1735488000&token=1srnZGLKZ0Aqlz6dk7yF4SkiYf4eP-YrEOdM1sob:XyvBDZFo3TrbEqKSZaK-Etd5YLc=",stepOneBg:"https://s1.chu0.com/src/img/jpg/ed/ed05981935f34ed9945038155f2e9217.jpg?imageMogr2/auto-orient/thumbnail/!240x320r/crop/!240x320a0a0/quality/85/&e=1735488000&token=1srnZGLKZ0Aqlz6dk7yF4SkiYf4eP-YrEOdM1sob:vKUQPG9X75xeyZym47cuglnjW2M=",gameBg:"https://s1.chu0.com/pvimg/img/png/e7/e7fb749c77ab425cb57fb2228f178ebe.png?imageMogr2/auto-orient/thumbnail/!240x320r/crop/!240x320a0a0/quality/85/&e=1735488000&token=1srnZGLKZ0Aqlz6dk7yF4SkiYf4eP-YrEOdM1sob:ByvTVB8r2ImXN--Nbzkh31UGcQU=",plane:{width:50,height:42,img:"https://s1.chu0.com/src/img/png/86/862ed62f179b47c6aaf9ebb32c7977ab.png?e=1735488000&token=1srnZGLKZ0Aqlz6dk7yF4SkiYf4eP-YrEOdM1sob:75PTGCPW2Cmk6-S3lgPSzNlBrPY="},planeCartridge:{width:34,height:34,img:"https://s1.chu0.com/pvimg/img/png/ec/ec6f3ccf3e8b4af8a06b0514848b97a2.png?e=1735488000&token=1srnZGLKZ0Aqlz6dk7yF4SkiYf4eP-YrEOdM1sob:oyqwMdKvkw5omB66aM15C_nRZmg="},enemyPlane1:{width:40,height:34,img:"https://s1.chu0.com/src/img/png/97/9785fe1f3141451ea61fced10d502720.png?e=1735488000&token=1srnZGLKZ0Aqlz6dk7yF4SkiYf4eP-YrEOdM1sob:KoRxw9iRb1V1Q0v2n_1bZ1fzhFQ="}},stage:{},beginLayer:{}}},mounted(){this.init()},methods:{createStage(){let a=document.getElementById("aircraftBattle"),t=a.offsetWidth,e=a.offsetHeight;this.stage=new Konva.Stage({container:"aircraftBattle",width:t,height:e})},beginDraw(){let{stage:a,imgs:{beginBtn:t,stepOneBg:e}}=this;this.beginLayer=new Konva.Layer,this.stage.add(this.beginLayer);let n={beginBtn:t,stepOneBg:e};this.loadImages(n,this.beginDrawPage)},loadImages(a,t){var e={},n=0,i=0;for(var d in a)i++;for(var d in a)e[d]=new Image,e[d].onload=function(){++n>=i&&t(e)},e[d].src=a[d]},beginDrawPage(a){let{stage:t}=this,e=new Konva.Image({image:a.beginBtn,x:t.width()/2-178/2,y:t.height()/2-70/2,width:178,height:70});e.on("tap",()=>{this.beginLayer.destroy(),this.beginLayer={},this.loadImages({gameBg:this.imgs.gameBg,plane:this.imgs.plane.img,enemyPlane1:this.imgs.enemyPlane1.img,planeCartridge:this.imgs.planeCartridge.img},this.gameDraw)}),e.on("mouseover",()=>{document.body.style.cursor="pointer"}),e.on("mouseout",()=>{document.body.style.cursor="default"});var n=new Konva.Image({image:a.stepOneBg,x:0,y:0,width:t.width(),height:t.height()});this.beginLayer.add(n),this.beginLayer.add(e),this.beginLayer.draw()},gameDraw(a){let{stage:t,imgs:e}=this,n=new Konva.Layer,i=new Konva.Image({image:a.plane,x:t.width()/2-e.plane.width/2,y:t.height()-e.plane.height,width:e.plane.width,height:e.plane.height}),d=new Konva.Image({image:a.gameBg,x:0,y:0,width:t.width(),height:t.height()});n.add(d),n.add(i),t.add(n);let h=0;function l(r,g){h||(h=setTimeout(()=>{new Konva.Tween({node:i,duration:.1,x:r,y:g}).play(),h=0,clearTimeout(h)},80))}function f(){let r=new Konva.Image({image:a.planeCartridge,x:i.x()+e.plane.width/2-e.planeCartridge.width/2,y:i.y()-e.planeCartridge.height,width:e.planeCartridge.width,height:e.planeCartridge.height});n.add(r),new Konva.Tween({node:r,duration:2*i.y()/t.height(),y:0,onFinish:()=>{r.destroy()}}).play()}document.onkeydown=function(r){let g=r.keyCode,o=i.x(),s=i.y(),m=40;switch(g){case 32:f();break;case 37:l(o-m,s);break;case 38:l(o,s-m);break;case 39:l(o+m,s);break;case 40:l(o,s+m);break}};let c=setTimeout(()=>{y()},1e3);function y(){let r=new Konva.Image({image:a.enemyPlane1,x:Math.random()*(t.width()-e.enemyPlane1.width),y:0,width:e.enemyPlane1.width,height:e.enemyPlane1.height});n.add(r),new Konva.Tween({node:r,duration:10,y:t.height(),onFinish:()=>{r.destroy()}}).play(),c=setTimeout(()=>{y()},Math.floor(Math.random()*1e3+1e3))}function p(){let r=n.find("Image"),g=n.find("Image");r.forEach(o=>{g.forEach(s=>{o.x()>s.x()&&o.x()<s.x()+e.enemyPlane1.width&&o.y()>s.y()&&o.y()<s.y()+e.enemyPlane1.height&&(o.destroy(),s.destroy())})})}function u(){n.find("Image").forEach(g=>{i.x()>g.x()&&i.x()<g.x()+e.enemyPlane1.width&&i.y()>g.y()&&i.y()<g.y()+e.enemyPlane1.height&&(g.destroy(),i.destroy(),clearTimeout(c),clearTimeout(h),document.onkeydown=null,alert("\u6E38\u620F\u7ED3\u675F"))})}setInterval(()=>{p()},100),setInterval(()=>{u()},100),t.add(n)},async init(){await this.$nextTick(),this.createStage(),this.beginDraw()}}},w={};var x=b(k,v,_,!1,P,"69788e36",null,null);function P(a){for(let t in w)this[t]=w[t]}var K=function(){return x.exports}();export{K as default};
