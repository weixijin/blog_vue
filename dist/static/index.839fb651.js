import{n as o,b as s,h as l}from"./index.25833e42.js";import{c}from"./chatItem.cc13e145.js";var m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("TrainPage",{ref:"TrainPageRef",attrs:{searchConfig:e.searchConfig,tableConfig:e.tableConfig,sendUrl:"get_chat_list",customize:!1,othData:{type:2}},scopedSlots:e._u([{key:"content",fn:function(i){var r=i.record;return[a("chatItem",{attrs:{row:r,isAdminPage:""}})]}}])})],1)},d=[];const u={name:"netdistList",components:{chatItem:c},data(){return{roomOptions:[],searchConfig:[{label:"\u804A\u5929\u5BA4",type:"select",modelName:"room_id",options:async()=>(await this.$apis.get_im_rooms({cache:!0})).data.data.map(t=>({label:t.im_name,value:t._id}))},{label:"\u6210\u5458",type:"select",modelName:"author_id",options:async()=>{const e=await this.$apis.get_im_rooms({cache:!0});return this.roomOptions=e.data.data.map(t=>({label:t.im_name,value:t._id})),this.roomOptions}},{label:"\u804A\u5929\u5185\u5BB9",type:"input",modelName:"content"},{label:"\u65F6\u95F4\u8303\u56F4",type:"datetimerange",modelName:["start_time","end_time"],isArray:!0,valueType:"timestamp",pickerOptions:this.getPickerOptions()}],tableConfig:{isSelection:!1,maxHeightFlag:!1,stripe:!0,filterData:e=>e.map(t=>{let{im_room_id:a,author_id:i,created_time:r}=t;return{...t,_username:i==null?void 0:i.username,_room_name:this.getRoomName(a),_created_time:this.klDateFormat(r)}}),columnObj:[{label:"\u53D1\u5E03\u4EBA",width:200,props:"_username"},{label:"\u804A\u5929\u5BA4",width:200,props:"_room_name"},{label:"\u53D1\u5E03\u65F6\u95F4",props:"_created_time",width:200},{label:"\u5185\u5BB9",props:"content",slot:"content"},{label:"\u64CD\u4F5C",slot:"projectDetail",props:"action",lock:!0,fixed:"right",children:[{label:"\u5220\u9664",type:"danger",clickFn:e=>{this.delSys(e._id)}}]}]}}},methods:{getRoomName(e){var t;return((t=this.roomOptions.find(a=>a.value==e))==null?void 0:t.label)||""},async delSys(e){!await this.$confirm("\u786E\u8BA4\u5220\u9664\u8BE5\u8BB0\u5F55\u5417\uFF1F").catch(()=>!1)||(await this.$apis.del_im_sys({_id:e}),this.initTable())},getSize(e){return+e?e<1024?e+"B":e<1024*1024?(e/1024).toFixed(2)+"KB":(e/1024/1024).toFixed(2)+"MB":"\u672A\u77E5"},async DialogEvent({type:e,ac_id:t}){!this.$refs.EditAcDialogRef||e==="add"&&(this.ac_id="",this.$refs.EditAcDialogRef.title="\u8D44\u6E90\u4E0A\u4F20",this.$refs.EditAcDialogRef.dialogVisible=!0)},download(e){let{netdisk_url:t}=e;window.open(s+t)},copyLink(e){let{netdisk_url:t}=e;this.copy({data:s+t,success:()=>{this.$message.success("\u590D\u5236\u6210\u529F")},fail:()=>{this.$message.error("\u590D\u5236\u5931\u8D25")}})},async putNetdist({_id:e},t="1"){!e||!await this.$confirm(+t==1?"\u786E\u5B9A\u7981\u7528\u5417\uFF1F":"\u786E\u5B9A\u5220\u9664\u5417?").catch(()=>!1)||l.putNetdist({_id:e,netdisk_status:t}).then(()=>{this.$message.success("\u64CD\u4F5C\u6210\u529F")}).catch(()=>{}).finally(()=>{this.initTable()})}}},n={};var p=o(u,m,d,!1,_,null,null,null);function _(e){for(let t in n)this[t]=n[t]}var g=function(){return p.exports}();export{g as default};
