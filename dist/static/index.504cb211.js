import{n as o,i as c}from"./index.25833e42.js";var h=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"page-1"},[e("div",{class:["",t.IS_PC?"w-1200 page-content blog-html-page-pc":"m-page-content"]},[e("kl-scroll",{attrs:{isBar:!1,pageOption:t.pageOption,list:t.list,scrollHeight:t.scrollHeight},on:{bottom:t.bottomEvent}},t._l(t.list,function(a){return e("div",{key:a._id,staticClass:"collect-item"},[e("h2",{staticClass:"m-b-10"},[t._v(" "+t._s(t.getCreateTime(a.article_updata_time))+" ")]),e("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"blog-html-page"},[e("div",{domProps:{innerHTML:t._s(a.article_content)}}),t.IS_PC?e("div",{staticClass:"flex-wrap flex-justify-end m-t-10"},[e("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(s){return t.edit(a)}}},[t._v("\u7F16\u8F91")])],1):t._e()])])}),0)],1)])},p=[];const _={data(){return{rowCopy:{content:""},visable:!1,collectClassList:[],list:[],scrollHeight:500,pageOption:{page:1,limit:8,total:0},channel:null}},computed:{IS_PC(){return this.isPc()}},created(){Object.assign(this.pageOption,this.createPages()),this.init()},mounted(){this.scrollHeight=document.documentElement.clientHeight,this.channel=new BroadcastChannel("experience_record"),this.channel.onmessage=t=>{if(t.data){let{_id:i,article_content:e}=t.data;this.list=this.list.map(a=>(a._id===i&&(a.article_content=e),a))}}},beforeDestroy(){this.channel.close()},methods:{createPages(){return this.IS_PC?{page:1,limit:7,total:0}:{page:1,limit:4,total:0}},edit(t){window.open(`#/blog/admin_article?_id=${t._id}&from=experience_record`)},bottomEvent(){let{page:t,limit:i,total:e}=this.pageOption;t*i>=e||(this.pageOption.page++,this.getArticles())},getCreateTime(t){return this.klDateFormat(new Date(t).getTime(),"yyyy-MM-dd hh:mm:ss")},getArticles(){let{page:t,limit:i}=this.pageOption;c({page:t,limit:i,class_mark:1}).then(async e=>{let{total:a,list:s}=e.data;if(Array.isArray(s)){this.pageOption.total=a-0,this.list=[...this.list,...s],await this.$nextTick();let l=Array.from(document.querySelectorAll(".blog-html-page img"));this.isArrayLength(l)&&l.forEach(n=>{$(n).unbind("click").click(()=>{this.prevewImg(n)})})}}).catch(()=>{})},init(){this.getArticles()}}},r={};var g=o(_,h,p,!1,d,"5fe3a15f",null,null);function d(t){for(let i in r)this[i]=r[i]}var u=function(){return g.exports}();export{u as default};
