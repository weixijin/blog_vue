import{h as p,n as d}from"./index.25833e42.js";var m=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"err_info_list c-555"},[t("TrainPage",{ref:"TrainPageRef",attrs:{searchConfig:e.searchConfig,tableConfig:e.tableConfig,sendUrl:"get_errs",customize:"",othData:e.othData}},[t("template",{slot:"btnList"},[t("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteErrs(null)}}},[e._v(" \u6309\u6761\u4EF6\u5220\u9664 ")])],1)],2),t("e-dialog",{attrs:{title:"\u8BE6\u60C5",width:"65%",footer:!1},model:{value:e.dialogVisible,callback:function(a){e.dialogVisible=a},expression:"dialogVisible"}},[t("div",{staticClass:"p-20"},e._l(e.getRowData(e.rowData),function(a,n){return t("div",{key:n,staticClass:"m-b-10 flex-wrap"},[t("div",{staticClass:"flex-0 w-90 t-a-r"},[e._v(" "+e._s(n)+" ")]),e._v(" : "),t("div",{staticClass:"m-l-10"},[e.isObject(a)?t("div",[e._v(" { "),e._l(a,function(i,r){return t("div",{key:r,staticClass:"m-b-10 flex-wrap"},[t("div",{staticClass:"flex-0 w-90 t-a-r"},[e._v(" "+e._s(r)+" ")]),e._v(" : "),t("div",{staticClass:"m-l-10"},[e._v(" "+e._s(i)+" ")])])}),e._v(" } ")],2):[e._v(" "+e._s(a)+" ")]],2)])}),0)])],1)},y=[];const h={data(){return{dialogVisible:!1,rowData:{},othData:{},searchConfig:[{label:"\u9519\u8BEF\u5185\u5BB9",type:"input",modelName:"content"},{label:"\u5E73\u53F0",type:"select",modelName:"type",options:()=>this.errsTypeOptions},{label:"\u65F6\u95F4\u8303\u56F4",type:"datetimerange",modelName:["start","end"],isArray:!0,valueType:"timestamp",pickerOptions:this.getPickerOptions()}],tableConfig:{isSelection:!1,maxHeightFlag:!1,stripe:!0,filterData:e=>e.map(s=>{let{create_time:t,type:a}=s;return{...s,create_time_:this.klDateFormat(t),type:this.getLabel(this.errsTypeOptions,a)}}),columnObj:[{label:"\u65F6\u95F4",props:"create_time_",width:"200px"},{label:"\u5E73\u53F0",props:"type",width:"150px"},{label:"\u94FE\u63A5/\u63A5\u53E3",props:"url"},{label:"\u9519\u8BEF\u5185\u5BB9",props:"content"},{label:"\u64CD\u4F5C",props:"action",lock:!0,fixed:"right",slot:"projectDetail",children:[{label:"\u67E5\u770B\u9879\u60C5",type:"primary",clickFn:e=>{this.handTableEvent("edit",e)}},{label:"\u5220\u9664",type:"danger",clickFn:e=>{this.handTableEvent("delete",e)}}]}]},tableData:[],pageOption:{page:1,limit:30,pageSizes:[30,50,100],total:0},query:{content:"",start:"",end:"",type:""},timeArr:""}},computed:{...Vuex.mapState(["options","RP"]),...Vuex.mapGetters(["errsTypeOptions"])},methods:{getPickerOptions(){const e=this;return{shortcuts:[{text:"\u4ECA\u65E5",onClick(s){const[t,a,n]=e.klDateFormat(new Date,"[yyyy,MM,dd]"),i=new Date(`${t}-${a}-${n} 23:59:59`),r=new Date(`${t}-${a}-${n} 00:00:00`);r.setTime(r.getTime()),s.$emit("pick",[r,i])}},{text:"\u672C\u5468",onClick(s){const[t,a,n]=e.klDateFormat(new Date,"[yyyy,MM,dd]");let i=e.getWeek(t,a,n);const r=new Date(`${t}-${a}-${n} 23:59:59`).getTime(),l=new Date,o=new Date(e.klDateFormat(r+(7-i)*3600*24*1e3));l.setTime(r+1e3-3600*1e3*24*i),s.$emit("pick",[l,o])}},{text:"\u672C\u6708",onClick(s){const[t,a,n]=e.klDateFormat(new Date,"[yyyy,MM,dd]"),i=e.getMonthDays(t,a),r=new Date(`${t}-${a}-${n} 23:59:59`).getTime(),l=new Date,o=new Date(e.klDateFormat(r+(i-n)*3600*24*1e3));l.setTime(r+1e3-3600*1e3*24*i),s.$emit("pick",[l,o])}},{text:"\u6700\u8FD1\u534A\u5E74",onClick(s){const t=new Date,a=new Date;a.setTime(a.getTime()-3600*1e3*24*180),s.$emit("pick",[a,t])}}]}},getRowData(e){if(e.url)try{e.url=JSON.parse(e.url)}catch{e.url=e.url}if(e.content)try{e.content=JSON.parse(e.content)}catch{e.content=e.content}return e},handTableEvent(e,s){switch(e){case"delete":this.deleteErrs(s);break;case"edit":this.dialogVisible=!0,this.rowData=s;break}},deleteErrs(e){let s="\u6B64\u64CD\u4F5C\u5C06\u6309\u6761\u4EF6\u5168\u90E8\u5220\u9664, \u662F\u5426\u7EE7\u7EED?",t=this.getType(e);t=="object"&&(s="\u786E\u5B9A\u5220\u9664\u5417\uFF1F"),this.$confirm(s,"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{var n;let a={my_type:0};if(t=="object")a._id=e._id;else{let{content:i,start:r,end:l,type:o}=(n=this.$refs.TrainPageRef.searchData)!=null?n:{};a={content:i,start:r,end:l,type:o,my_type:1}}if(a=this.filterQuery(a),Object.keys(a).length==1){this.$message({type:"error",message:"\u8BF7\u5148\u9009\u62E9\u6761\u4EF6"});return}p.del_errs(a).then(i=>{this.$message.success(i.msg||"\u64CD\u4F5C\u6210\u529F"),this.initTable({},!1,!1)}).catch(i=>{this.saveError(i)})}).catch(()=>{this.$message({type:"info",message:"\u5DF2\u53D6\u6D88\u5220\u9664"})})}}},c={};var u=d(h,m,y,!1,f,null,null,null);function f(e){for(let s in c)this[s]=c[s]}var _=function(){return u.exports}();export{_ as default};
