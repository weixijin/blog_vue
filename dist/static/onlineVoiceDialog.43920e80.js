import{n as r,_ as l}from"./index.25833e42.js";var n=function(){var e=this,i=e.$createElement,a=e._self._c||i;return a("kl-dialog",{attrs:{width:"300px",center:"",header:!1,footer:!1,dialogVisible:e.visable},on:{"update:dialogVisible":function(t){e.visable=t},"update:dialog-visible":function(t){e.visable=t}}},[a("div",{staticClass:"flex-column-wrap p-20 flex-center-wrap pr p-t-40",on:{click:function(t){return t.stopPropagation(),function(){}.apply(null,arguments)}}},[a("i",{staticClass:"f-20 f-600 c-555 cu el-icon-close p-a el-icon-close-1",on:{click:function(t){return t.stopPropagation(),e.close.apply(null,arguments)}}}),a("e-image",{staticClass:"b-r-50 o-h",attrs:{height:80,lazy:!1,src:"http://139.9.210.43:5000/netdist/kl1718850348458vjab00h8x4d-1718850348280~1~.png"}}),a("div",{staticClass:"m-t-20"},[e._v("\u901A\u8BDD\u65F6\u957F\uFF1A"+e._s(e.getAudioTime))]),a("el-button",{staticClass:"m-t-20",attrs:{type:"danger",size:"small"},on:{click:function(t){return t.stopPropagation(),e.stop.apply(null,arguments)}}},[e._v("\u6302\u65AD")])],1)])},c=[];const u={components:{audioPlay:()=>l(()=>import("./index.ec291ae7.js"),["static/index.ec291ae7.js","static/index.12e1667e.css","static/index.25833e42.js","static/index.8776284e.css"])},props:{value:{type:Boolean,default:!1}},data(){return{isShowAudio:!1,filePath:"",file:null,mediaRecorder:null,isStart:!1,audioTime:0,timer:null}},computed:{visable:{get(){return this.value},set(){return this.$emit("input",!this.value)}},getAudioTime(){return(this.audioTime/1e3).toFixed(1)+"s"}},watch:{value(e){if(e){this.init();return}}},beforeDestroy(){this.clearTimer(),this.audioTime=0},methods:{stop(){this.clearTimer(),this.mediaRecorder.stop()},close(){this.filePath="",this.mediaRecorder=null,this.file=null,this.visable=!1,this.clearTimer(),this.audioTime=0},clearTimer(){clearInterval(this.timer),this.timer=null},init(){if(!this.mediaRecorder){if(!navigator||!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){this.$klMessage("\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u5F55\u97F3\u529F\u80FD");return}this.clearTimer(),this.audioTime=0,navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>{const i=new MediaRecorder(e);console.log("stream",e);const a=[];i.ondataavailable=t=>{t.data.size>0&&(console.log(555,t.data),a.push(t.data))},i.onstop=()=>{const t=new Blob(a,{type:"audio/ogg; codecs=opus"}),o="recordedAudio.ogg";this.file=new File([t],o,{type:"audio/ogg"}),this.filePath=this.getObjectURL(this.file)},i.start(),this.mediaRecorder=i,this.timer=setInterval(()=>{if(this.audioTime>=60*1e3){this.clearTimer();return}this.audioTime+=50},50)}).catch(e=>{console.error("Error accessing the microphone:",e)})}}}},s={};var d=r(u,n,c,!1,h,"2c74e569",null,null);function h(e){for(let i in s)this[i]=s[i]}var p=function(){return d.exports}();export{p as default};
