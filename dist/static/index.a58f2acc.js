import{I as p,J as d,n as f}from"./index.25833e42.js";var m=function(){var t=this,l=t.$createElement,e=t._self._c||l;return e("div",{staticClass:"demo"},[t.IS_PC?t._e():e("div",{staticClass:"fix-header flex-center-wrap flex-justify-between"},[e("van-cell",{attrs:{width:"200",title:"\u9009\u62E9\u5355\u4E2A\u65E5\u671F",value:t.date},on:{click:function(a){t.show=!0}}}),e("el-button",{staticClass:"m-l-30",attrs:{type:"primary",size:"small"},on:{click:t.init}},[t._v("\u6E05\u7A7A")])],1),e("div",{ref:"klScrollRef",class:["scroll-page",t.IS_PC?"h-100vh":"m-t-30"]},[e("h3",[t._v("\u63A8\u9001\u4EFB\u52A1\u4E00")]),e("el-table",{staticClass:"zl-ui-table m-t-10",attrs:{id:"list-table",data:t.tableData1}},[e("el-table-column",{attrs:{width:"80px",prop:"type",label:"\u5206\u7C7B"},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.row;return[t._v(" "+t._s(t.getTypeLabel(n.type))+" ")]}}])}),e("el-table-column",{attrs:{prop:"content",label:"\u63A8\u9001\u5185\u5BB9"},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.row;return[e("div",{class:[n.note_link?"c-link":""],domProps:{innerHTML:t._s(n.content)},on:{click:function(o){return t.goToLink(n)}}})]}}])})],1),e("h3",{staticClass:"m-t-10"},[t._v("\u63A8\u9001\u4EFB\u52A1\u4E8C")]),e("el-table",{staticClass:"zl-ui-table m-t-10",attrs:{id:"list-table",data:t.tableData2}},[e("el-table-column",{attrs:{width:"120px",prop:"note_end_time",label:"\u7ED3\u675F\u65F6\u95F4"},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.row;return[t._v(" "+t._s(t.getTimeC(n))+" ")]}}])}),e("el-table-column",{attrs:{prop:"note_content",label:"\u5185\u5BB9"},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.row;return[e("div",{class:["my-class-c-"+n.my_type,n.note_link?"c-link":""],domProps:{innerHTML:t._s(n.note_content)},on:{click:function(o){return t.goToLink(n)}}})]}}])})],1)],1),e("van-calendar",{attrs:{"min-date":t.minDate,"max-date":t.maxDate,color:"#3399FF","show-confirm":!1},on:{confirm:t.onConfirm},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}})],1)},y=[];const[_]=p(Date.now(),"[yyyy]"),b={components:{},data(){return{scrollTop:0,date:"",show:!1,tableData1:[],tableData2:[],minDate:new Date(_-1,0,1),maxDate:new Date(_+1,0,31)}},watch:{date(t){this.get_day_push_tasks()}},computed:{...Vuex.mapState(["options"]),pushDaskTypes(){let{options:t}=this;return this.isObject(t)?t.pushDaskTypes||[]:[]},IS_PC(){return this.isPc()}},created(){this.init()},async activated(){if(this.IS_PC)return;await this.$nextTick();let{klScrollRef:t}=this.$refs;t&&(t.scrollTop=this.scrollTop)},deactivated(){if(this.IS_PC)return;let{klScrollRef:t}=this.$refs;t&&(this.scrollTop=t.scrollTop||0)},methods:{goToLink({note_link:t}){!t||this.goTo(t,{target:this.IS_PC?"_blank":"_self"})},getTimeC(t){let{date:l}=this,e=24*60*60*1e3,a=new Date(l).getTime(),{note_begin_time:n,note_end_time:o}=t;if(n-a>0)return`\u8FD8\u6709${Math.abs(Math.floor((n-a)/e))}\u5929\u5F00\u59CB`;if(a-o>0)return`\u5DF2\u7ED3\u675F${Math.abs(Math.floor((a-o)/e))}\u5929`;if(o-a>0)return`\u8FD8\u6709${Math.abs(Math.floor((o-a)/e))}\u5929\u7ED3\u675F`},getTypeLabel(t){let l=this.pushDaskTypes.find(e=>e.value==t);return l?l.label:""},get_day_push_tasks(){let{date:t}=this;!t||d({time:new Date(t).getTime()}).then(async l=>{let{notes:e,pushTasks:a}=l.data;this.tableData1=a||[],this.tableData2=e||[],this.tableData1=this.tableData1.map(s=>({...s,content:s.content.replace(/\n/g,"<br>")})),this.tableData2=this.tableData2.map(s=>({...s,note_content:s.note_content.replace(/\n/g,"<br>")}));let n=[],o=new Date(t).getTime();this.tableData2.forEach(s=>{let{note_begin_time:r,note_end_time:i}=s;o-i>0&&n.push({...s,my_type:1})}),this.tableData2.forEach(s=>{let{note_begin_time:r,note_end_time:i}=s;r-o<=0&&o-i<=0&&n.push({...s,my_type:2})});let c=[];this.tableData2.forEach(s=>{let{note_begin_time:r,note_end_time:i}=s;r-o>0&&c.push({...s,my_type:3})}),c.sort((s,r)=>s.note_begin_time-r.note_begin_time),this.tableData2=[...n,...c],await this.$nextTick();let h=document.querySelector(".scroll-page");h.scrollTop=0}).catch(l=>{console.log(l),this.$message.error("\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9\u65E5\u671F")})},formatDate(t){return`${t.getMonth()+1}/${t.getDate()}`},onConfirm(t){this.show=!1,this.date=this.klDateFormat(new Date(t).getTime(),"yyyy/MM/dd")},init(){this.date=this.klDateFormat(Date.now(),"yyyy/MM/dd")}}},u={};var v=f(b,m,y,!1,D,"800216dc",null,null);function D(t){for(let l in u)this[l]=u[l]}var k=function(){return v.exports}();export{k as default};
